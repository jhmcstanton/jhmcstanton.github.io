var parentTable=document.getElementsByTagName('table')[0],dmeField=0,lmeField=dmeField+1,dmeTable=document.getElementsByTagName('table')[1],lmeTable=document.getElementsByTagName('table')[2],numField=function(id){return parseInt(document.getElementById(id).value)},efficiency=function(){return numField('efficiency')},batchSize=function(){return numField('batchSize')},extractWeight=function(field){var weightNode=parentTable.getElementsByTagName('input')[field];if(weightNode.value==='')return 0;return parseFloat(weightNode.value)},sg=function(field,percent){var weight=extractWeight(field),sg=weight*45*percent/batchSize(),weightNode=parentTable.getElementsByTagName('input')[field];weightNode.parentNode.nextSibling.nextSibling.innerHTML=(sg/1000)+1;return sg},setGrainAmounts=function(table,extractWeight,sg){var rows=Array.from(table.getElementsByTagName('tr')).slice(1);console.log('confused');rows.forEach(function(row){setGrainAmount(row,extractWeight,sg)})},setGrainAmount=function(row,extractWeight,sg){var childValStr=row.childNodes[3].childNodes[0].value;if(childValStr==='')return;var childVal=parseInt(childValStr),grainWeight=childVal*extractWeight*sg/(sg*efficiency());row.childNodes[5].innerHTML=grainWeight},updateAll=function(){var dmeSg=sg(dmeField,1),lmeSg=sg(lmeField,0.8);setGrainAmounts(dmeTable,extractWeight(dmeField),dmeSg);setGrainAmounts(lmeTable,extractWeight(lmeField),lmeSg)};Array.from(document.getElementsByTagName('input')).forEach(function(input){input.addEventListener('input',updateAll)})