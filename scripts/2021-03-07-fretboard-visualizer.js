var sharps=['A','A#','B','C','C#','D','D#','E','F','F#','G','G#'],flats=['A','B♭','B','C','D♭','D','E♭','E','F','G♭','G','A♭'],getNoteMaker=function(arr){return function(i){return arr[Math.abs(i)%12]}},getSharpNote=getNoteMaker(sharps),getFlatNote=getNoteMaker(flats),noteMaps={'sharp':getSharpNote,'flat':getFlatNote},makeStandardTuning=function(note){note=note.toUpperCase();var notes=[note];for(var i=sharps.indexOf(note)+5;notes.length<6;i+=5){if(notes.length==4)i--;notes.push(getSharpNote(i))};return notes},makeDropTuning=function(note){var notes=makeStandardTuning(getSharpNote(sharps.indexOf(note)+2%12));notes[0]=getSharpNote(sharps.indexOf(notes[0])-2%12);return notes},makeFlatTuning=function(notes){var newNotes=[];notes.forEach(function(note){newNotes.push(flats[sharps.indexOf(note)])});return newNotes},tunings={'E Standard':makeStandardTuning('E'),'Drop D':makeDropTuning('D'),'Open A':['E','A','C#','E','A','E'],'Open B':['B','F#','B','F#','B','D#'],'Open C':['C','G','C','G','C','E'],'Open D':['D','A','D','F#','A','D'],'Open E':['E','B','E','G#','B','E'],'Open F':['C','F','C','F','A','C'],'Open G':['D','G','D','G','B','D'],'E♭ Standard':makeFlatTuning(makeStandardTuning('D#')),'Drop D♭':makeFlatTuning(makeDropTuning('C#')),'D Standard':makeStandardTuning('D'),'Drop C':makeDropTuning('C'),'C# Standard':makeStandardTuning('C#'),'Drop B':makeDropTuning('B'),'C Standard':makeStandardTuning('C'),'Drop B♭':makeFlatTuning(makeDropTuning('A#')),'B Standard':makeStandardTuning('B'),'Drop A':makeDropTuning('A'),'A# Standard':makeStandardTuning('A#'),'Drop G#':makeDropTuning('G#'),'A Standard':makeStandardTuning('A'),'Drop G':makeDropTuning('G')},tuning=document.getElementById('tuning').value,numStrings=6,numFrets=parseInt(document.getElementById('numFrets').value),useSharps=document.getElementById('accidentalType').value==='Sharp',high2low=document.getElementById('high2low').value==='High to Low',updateTuningByName=function(newTuning){tuning=tunings[newTuning];var notes=useSharps?sharps:flats,selectors=document.getElementsByClassName('stringNoteSelector');for(var i=0;i<selectors.length;i++){var note=tuning[i],stringSelect=selectors[i];stringSelect.selectedIndex=notes.indexOf(note)};buildFretboard(tuning)},buildFretboard=function(stringNotes){var board=document.getElementById('fretboard');board.innerHTML="";var allNotes=useSharps?noteMaps['sharp']:noteMaps['flat'];stringNotes.forEach(function(note){var string=board.insertRow(high2low?0:-1),startIndex=sharps.indexOf(note);startIndex=startIndex>=0?startIndex:flats.indexOf(note);for(var i=startIndex;i<startIndex+numFrets;i++){var fret=string.insertCell(-1);fret.innerHTML=allNotes(i)}});var header=board.insertRow(0);for(var i=1;i<=numFrets;i++){var cell=header.insertCell(-1);if(i%2===1&&[1,11,13].indexOf(i)===-1){cell.innerHTML="⬤"}else if(i===12)cell.innerHTML="⬤ ⬤"}},updateFrets=function(num){numFrets=parseInt(num);buildFretboard(tuning)},updateAccidental=function(accType){useSharps=accType==='Sharp';buildFretboard(tuning)},updateDisplayDirection=function(dir){high2low=dir==='High to Low';buildFretboard(tuning)},updateString=function(strEl,strIndex){tuning[strIndex]=strEl.value;buildFretboard(tuning)},tuningEl=document.getElementById('tuning');for(var key in tunings){var tuningOption=document.createElement('option');tuningOption.text=key;tuningEl.add(tuningOption)};updateTuningByName('E Standard');var tuningRow=document.getElementById('tuningTable'),_loop_1=function(i){var currentNote=tuning[i],notes=useSharps?sharps:flats,string=tuningRow.insertCell(-1),stringSelect=document.createElement('select');stringSelect.className='stringNoteSelector';stringSelect.onchange=function(){return updateString(stringSelect,i)};string.appendChild(stringSelect);notes.forEach(function(note){var noteOpt=document.createElement('option');noteOpt.text=note;stringSelect.add(noteOpt)});stringSelect.selectedIndex=notes.indexOf(currentNote)};for(var i=0;i<numStrings;i++)_loop_1(i)